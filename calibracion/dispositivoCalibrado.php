<?php	try {			$conexion=include ("../db_connect.php");			$db = new DB_CONNECT();			 			$result = array();			$result["error"] = 0;			$result["descripcion"] = '';			$result["total"] = 10;			$result["rows"] = array();			$rows_reg = 10;			$query = ' ';			$flag=-1;			$id_dis = isset($_GET['id_dis']) ? $_GET['id_dis'] : $flag;			$flagHistoAsig = isset($_GET['flagHistoAsig']) ? $_GET['flagHistoAsig'] : $flag;						if($id_dis!=$flag && $flagHistoAsig==$flag){				$query = " SELECT CAL.db_permitido as db, CAL.dist_permitido as distancia FROM histoasignacion as HA INNER JOIN calibracion as CAL ON HA.id=CAL.id_AsiDis WHERE (HA.id_dis='$id_dis' and HA.fechaBaja='1900-01-01')";				$rs = mysql_query(" SELECT count(*) FROM histoasignacion as HA INNER JOIN calibracion as CAL ON HA.id=CAL.id_AsiDis WHERE (HA.id_dis='$id_dis' and HA.fechaBaja='1900-01-01')");			}else{				$query = " select dispositivo.MAC, dispositivo.id as id_dis from dispositivo WHERE dispositivo.id NOT IN (SELECT id_dis FROM histoasignacion WHERE histoasignacion.fechaBaja='1900-01-01') and dispositivo.id='$id_dis'";				$rs = mysql_query(" select count(*) from dispositivo WHERE dispositivo.id NOT IN (SELECT id_dis FROM histoasignacion WHERE histoasignacion.fechaBaja='1900-01-01') and dispositivo.id='$id_dis'");			}						$row = mysql_fetch_row($rs);			$result["total"] = $row[0];			$rows_reg = $result["total"];			$rs = mysql_query($query) or die(mysql_error());			$rows = array();			while ($row = mysql_fetch_object($rs)) { //Recupera una fila del objeto $rs				array_push($rows, $row);			}			$result["rows"] = $rows;			//Busco posibles errores:			if ($result["total"] <= 0) {				$result["error"] = -1;				$result["descripcion"] = "No existen datos de calibracion a mostrar";			}		} catch (exception $e) {			$result["error"] = -400;			$result["descripcion"] = "Error al ejecutar SQL";		}	echo json_encode($result);	?>